(function(e){var a=/CrOS/.test(navigator.userAgent);var i=a;if(/chrome_signup/i.test(location.pathname)){i=true}var h="";var c=0.12;function j(k){return !isNaN(parseFloat(k))&&isFinite(k)}function b(k,m,o,l){l=(l!=null&&l==false)?false:true;if((o+m)>=5000){return null}if(o==1&&m==0){return(currency=="AUD")?Math.round(119):Math.round(59)}var p=50;var n=0;if(m/o>20||(m+o)>o*20){p=Math.max(p,(m+o))}else{p=Math.max(p,(o*20))}if(currency=="AUD"){n=p*4}else{if(currency=="NZD"){n=p*5}else{if(l){if(p<=100){n=(p*2)-1}else{if(p<=200){n=199+(p-100)*1.5}else{if(p<=500){n=349+(p-200)*1.45}else{if(p<=1000){n=784+(p-500)*1.4}else{if(p<=2000){n=1484+(p-1000)*1.3}else{n=2784+(p-2000)*1.3}}}}}}else{if(p<=100){n=(p*2)-1}else{if(p<=200){n=199+(p-100)*1.5}else{if(p<=500){n=349+(p-200)*1.25}else{if(p<=1000){n=724+(p-500)*1.1}else{if(p<=2000){n=1274+(p-1000)*1}else{n=2249+(p-2000)*1}}}}}}}}if(i||k!="k12"){n*=1.5}return n}function d(){var m=parseInt(e("#school-student").val(),10);var o=parseInt(e("#school-teacher").val(),10);var k=e("#school-level").val();var n=("true"==e("#is_commoncraft").val())?true:false;if(j(m)&&j(o)&&o>0){var l=b(k,m,o,true);if(l===null){e(".school-plan-price").text("Get a custom quote");h="over"}else{if(n){l=Math.round(l*(1+c))}else{l=Math.round(l)}if(currency!="USD"){e(".school-plan-price").text(currency+" $"+number_format(l)+"/year")}else{e(".school-plan-price").text("$"+number_format(l)+"/year")}h="ok"}}else{h="";if(currency!="USD"){if(k=="k12"){e(".school-plan-price").text("Starting at AUD $200/year")}else{e(".school-plan-price").text("Starting at AUD $300/year")}}else{if(k=="k12"){e(".school-plan-price").text("Starting at $99/year")}else{e(".school-plan-price").text("Starting at $149/year")}}}}var g;function f(){if(g){clearTimeout(g)}g=setTimeout(function(){d()},300)}e("#school-teacher, #school-student").on("keyup paste change",function(m){var k=e(this).val(),l=/[^0-9]/;if(l.test(k)){e(this).val(k.replace(/[^0-9]/g,""))}f()});e("#get-order-form").on("submit",function(m){m.preventDefault();var k=e(this);var l=k.find('input[name="order_num"]').val();k.find(".help-block").empty();k.find(".form-group").removeClass("has-error");e.get("/ajax/checkOrderNum/"+l,function(n){if(n["return"]==true){document.location="/school_order/"+l}else{if(n.taken){}}if(n.error){k.find(".form-group").addClass("has-error");k.find(".help-block").text(n.error)}},"json");return false});e("#renew-login-form").on("submit",function(m){m.preventDefault();var k=e(this);var l=k.find(".form-message");l.empty();e.post("/ajax/signupRenewAccountRedirect",k.serialize(),function(n){if(n.error){l.text(n.error.message);return}if(n.redirect){document.location=n.redirect}else{$select=e('<select class="form-control" name="ex_id"></select>');var o="";e.each(n,function(p,q){o='<option value="'+q.ex_id+'">'+q.name+"</option>";$select.append(o)});e(".form-group-school > div").empty().append($select);e(".form-group-school").show();e(".form-group-email").hide();l.text("We identified several user accounts matching your email address.")}},"json");return false});e("#edsoft-check-renew").on("submit",function(n){n.preventDefault();var k=e(this);var l=k.find(".form-message");l.empty();var m=e("#school_url").val();if(m==""){l.text("Please enter the School Private URL");e("#school_url").focus();return}e.post("/ajax/edsoftRenewAccountRedirect",k.serialize(),function(o){if(o.error){l.text(o.error.message);return}if(o.redirect){document.location=o.redirect}},"json");return false});e(".dropdown-select").each(function(){var k=e(this);k.on("click","[data-value]",function(m){m.preventDefault();var l=e(this);l.parent().siblings().removeClass("active").end().addClass("active");k.data("selected",l.data("value"));k.find(".select-label").text(l.text());e("#school-level").val(l.data("value"));f()})});e("#school-teacher, #school-student").each(function(){var k=e(this);k.on("focusin",function(l){e('[for="'+k.attr("id")+'"]').tooltip("show")});k.on("focusout",function(l){e('[for="'+k.attr("id")+'"]').tooltip("hide")})});e(".plan-form-submit").click(function(k){k.preventDefault();if(h==""){if(e("#school-teacher").val().length==0){e("#school-teacher").focus()}else{e("#school-student").focus()}}else{if(h=="ok"){e(".plan-form").submit()}else{if(h=="over"){e("#custom-quote-modal").modal("show")}}}});e(".add_commoncraft").click(function(){location.href="#anchor_plan_content";e(".page-title").text("Pricing Including Common Craft");e("#commoncraft_link").show();e("#contact_info").hide();e("#is_commoncraft").val("true");e(".commoncraft-section").hide();e(".free-trial-section").hide();e(".no-free-commoncraft").show();e(".single_price_link").attr("href","/public_signup/order/teacher?is_commoncraft=true");e(".single_price_link_au").attr("href","/edsoft_signup/order/teacher?is_commoncraft=true");e("#single_price").text("66");e("#single_price_au").text("133");f()});e(".remove_commoncraft").click(function(){e(".page-title").text("Start Making Videos Today");e("#commoncraft_link").hide();e("#contact_info").show();e("#is_commoncraft").val("false");e(".commoncraft-section").show();e(".free-trial-section").show();e(".no-free-commoncraft").hide();e(".single_price_link").attr("href","/public_signup/order/teacher?is_commoncraft=false");e(".single_price_link_au").attr("href","/edsoft_signup/order/teacher?is_commoncraft=false");e("#single_price").text("59");e("#single_price_au").text("119");f()});e(document).ready(function(){var k=e("#school-level").val();e('[data-value="'+k+'"]').trigger("click");f();if(!e("body").hasClass("modal-open")){e("#school-teacher").focus()}})})(jQuery);
