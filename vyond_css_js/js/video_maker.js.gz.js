function checkthemeassetprovider(a){$.get("/ajax/checkthemeassetprovider/"+a,function(b){if(b.code=="require_login"){window.location=b.url}else{if(b.code=="fail"){var c=$("#payment-license-overlay");c.html(b.html).modal();$(".flexslider").flexslider({animation:"slide",itemWidth:600,itemMargin:50});c.scroll(function(){c.modal("handleUpdate")})}else{if(b.code=="pass"){window.location=b.url}}}},"json")}function browsethemeassetprovider(b,a){$(b).removeClass("hidden").siblings().addClass("hidden");if(typeof a!="undefined"){var c=$("<iframe></iframe>",{id:"payment-payment-iframe",name:"payment-payment-iframe",scrolling:"no",allowTransparency:"true",frameborder:"0",width:$("#theme-asset-modal").width()-2,height:680,src:a});$("#payment-payment-block").empty().html(c)}}function themeassetprovider_payment_confirm(a){browsethemeassetprovider("#payment-overlay-payment-confirmation");$("#payment-overlay-payment-confirmation").empty().html(a.html)}var submittedCoupon=false;function couponSubmit(){$("#payment-coupon-error-wrap").addClass("hidden");$("#payment-coupon-error").html("");provider=$("#payment-coupon-btn").data("provider"),code=$("#payment-coupon-input").val();if(!submittedCoupon){submittedCoupon=true;$.post("/ajax/paymentformbyCouponRedeem",{package_id:provider,coupon_code:code},function(a){if((a.code=="require_login")||(a.code=="redirect")){window.location=a.url}else{if(a.code=="fail"){$("#payment-coupon-error-wrap").removeClass("hidden");$("#payment-coupon-error").html(a.message)}else{if(a.code=="pass"){browsethemeassetprovider("#payment-overlay-payment",a.url)}}}submittedCoupon=false},"json")}}(function(b){ThemeFilter=function(){this.filters=[];this.themes=b("#themes");this.dropdown=b(".filter-dropdown");this.filterResults=b(".filter-results");this.filterCrumbList=b(".filter-crumb-list")};ThemeFilter.prototype={add:function(c){var d=this.filters.indexOf(c);if(d!=-1){return}this.filters.push(c);this.update()},remove:function(c){var d=this.filters.indexOf(c);if(d==-1){return}this.filters.splice(d,1);this.update()},clear:function(){this.filters=[];this.update()},update:function(){this.filterThemes();this.updateCrumb();this.updateDropdown()},filterThemes:function(){var c="";if(this.filters.length){for(i in this.filters){c+='[data-tags~="'+this.filters[i]+'"]'}}if(c){this.themes.find(".theme").parent().hide();this.themes.find(".theme").filter(c).parent().show()}else{this.themes.find(".theme").parent().show()}},updateCrumb:function(){var d=this;this.filterCrumbList.empty();if(this.filters.length==0){this.filterResults.slideUp("fast")}else{b.each(this.filters,function(f,e){d.filterCrumbList.append(d.createCrumb(e))});var c=this.themes.find(".theme:visible").length;this.filterResults.find(".filter-count").text(c);this.filterResults.slideDown("fast")}},createCrumb:function(c){var d=b('<li class="filter-crumb"></li>').data("filter",c);d.text(tagNames[c]).append('<a href=#">&#215;</a>');return d},updateDropdown:function(){var c=this.filters;this.dropdown.find(".filter-item").each(function(){var e=b(this),d=e.data("filter");e.toggleClass("active",(c.indexOf(d)>=0))})}};var a=new ThemeFilter();b(document).on("click",".filter-item",function(g){var f=b(this),d=f.hasClass("active"),c=f.data("filter");g.preventDefault();g.stopPropagation();if(!d){a.add(c)}else{a.remove(c)}}).on("click",".filter-crumb a",function(f){var d=b(this),c=d.parent().data("filter");f.preventDefault();a.remove(c)}).on("click",".filter-crumb-list-clear",function(c){c.preventDefault();a.clear()});b(document).on("click",'[data-action="biz-preview"]',function(g){var h=b(this),k=b("#biz-preview-overlay"),f=h.data("theme"),d=h.data("appType"),j=h.data("buttonText");g.preventDefault();k.find(".theme-name").text(f);k.find(".app-type").text(d);var m=k.find(".btn-cta").html(j);var c=h.data("href");var l=h.data("callback");m.prop("onclick",null).removeAttr("onclick");if(c){m.attr("onclick","window.location.href='"+c+"'")}else{if(l){m.attr("onclick",l)}}k.modal()})})(jQuery);